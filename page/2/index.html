<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="//gravatar.com/avatar/e8050a565f388a2d35b46a8ed2aa0147?s=180">
  <link rel="icon" type="image/png" sizes="32x32" href="//gravatar.com/avatar/e8050a565f388a2d35b46a8ed2aa0147?s=32">
  <link rel="icon" type="image/png" sizes="16x16" href="//gravatar.com/avatar/e8050a565f388a2d35b46a8ed2aa0147?s=16">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.31/dist/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"mudkip.me","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Mudkip Mud Sport">
<meta property="og:url" content="https://mudkip.me/page/2/index.html">
<meta property="og:site_name" content="Mudkip Mud Sport">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Mudkip">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://mudkip.me/page/2/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Mudkip Mud Sport</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start --><meta name="fediverse:creator" content="@mudkip@indieweb.social"><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Mudkip Mud Sport" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Mudkip Mud Sport</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Mudkip's Mud Sport Journal</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-uses"><a href="/uses/" rel="section"><i class="fa fa-computer fa-fw"></i>Uses</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Mudkip</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/mudkipme" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;mudkipme" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://indieweb.social/@mudkip" title="Mastodon → https:&#x2F;&#x2F;indieweb.social&#x2F;@mudkip" rel="noopener me" target="_blank"><i class="fab fa-mastodon fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_nd.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mudkip.me/2024/03/28/Notes-on-EndeavourOS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mudkip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/03/28/Notes-on-EndeavourOS/" class="post-title-link" itemprop="url">Notes on EndeavourOS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-03-28 00:02:07" itemprop="dateCreated datePublished" datetime="2024-03-28T00:02:07Z">2024-03-28</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/images/2024/03/plasma6.png" alt="KDE Plasma 6"></p>
<p>I have been using <a target="_blank" rel="noopener" href="https://endeavouros.com/">EndeavourOS</a> on my Dragon Canyon NUC for months. It is my chosen Linux distribution because it offers an easy-to-install Arch Linux environment, and I am familiar with Arch Linux. I need to stay on the cutting edge for desktop environments, display protocols, and graphics drivers due to issues with NVIDIA and the Linux desktop (especially Wayland). Many developments are <a target="_blank" rel="noopener" href="https://gitlab.freedesktop.org/xorg/xserver/-/merge_requests/967">happening</a> in real-time to improve them. With Arch Linux, I can easily install an AUR package from a merge request, as well as switch to beta drivers when they become <a target="_blank" rel="noopener" href="https://github.com/NVIDIA/egl-wayland/pull/104#issuecomment-2010292221">available</a>.</p>
<p>Wayland is important to me because I’m using a 27&quot; 4K display. For the best visual size, it should be set to 150% fractional scaling. KDE Plasma supports fractional scaling under Wayland and has an option to “<a target="_blank" rel="noopener" href="https://pointieststick.com/2022/06/17/this-week-in-kde-non-blurry-xwayland-apps/">let Xwayland applications scale themselves</a>” to prevent them from being blurry. That’s the reason I chose KDE as my desktop environment. Moreover, KDE Plasma 6 offers a nice experience both functionally and aesthetically.</p>
<p>Here is a note in Logseq that I use to track how I install and configure EndeavourOS. I’m interested in a declarative way to build operating systems and am slowly learning NixOS. However, in the meantime, I am very satisfied with my current EndeavourOS setup.</p>
<hr>
<ul>
<li>Configure the Windows Registry to use UTC hardware time:  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\TimeZoneInformation&quot; /v RealTimeIsUniversal /d 1 /t REG_DWORD /f</span><br></pre></td></tr></table></figure>
</li>
<li>Disable Secure Boot and Fast Boot in the BIOS. If Fast Boot is enabled, accessing the BIOS by pressing F2 is difficult. Instead, I have to use Settings &gt; System &gt; Recovery &gt; Advanced startup in Windows, and after rebooting, choose Troubleshoot &gt; Advanced options &gt; UEFI Firmware Settings to access the BIOS.</li>
<li>Flash the EndeavourOS ISO to a USB disk using <a target="_blank" rel="noopener" href="https://rufus.ie/en/">Rufus</a>, contrary to the <a target="_blank" rel="noopener" href="https://discovery.endeavouros.com/installation/create-install-media-usb-key/2021/03/">documentation</a> on the EndeavourOS website. I had to choose the GPT partition and ISO mode to make my PC recognize the boot drive.</li>
<li>Change network settings in KDE settings: manually set the IP address and DNS and gateway to <code>192.168.1.2</code>.</li>
<li>Install EndeavourOS using the online installer, KDE desktop environment, erasing the Samsung 970 EVO disk with btrfs and without swap.</li>
<li>Eject the USB disk and reboot into EndeavourOS.</li>
<li>Install <code>nvidia-inst</code> using <code>yay</code> and run <code>nvidia-inst</code> to install the GPU driver, then reboot again.</li>
<li>Disable the Dummy HDMI Plug in Display Settings and set the scale to 150%; turn off Adaptive Sync.</li>
<li>Fix the suspend issue by preserving video memory <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/NVIDIA/Tips_and_tricks#Preserve_video_memory_after_suspend">as described here</a>:
<ul>
<li><code>sudo nano /etc/modprobe.d/nvidia-power-management.conf</code>
<ul>
<li><code>options nvidia NVreg_PreserveVideoMemoryAllocations=1 NVreg_TemporaryFilePath=/var/tmp</code></li>
</ul>
</li>
<li>sudo systemctl enable nvidia-suspend.service</li>
<li>sudo systemctl enable nvidia-hibernate.service</li>
<li>sudo reinstall-kernels</li>
</ul>
</li>
<li>Install the <code>xorg-xwayland-explicit-sync-git</code> and <code>egl-wayland-git</code> AUR packages using <code>yay</code>. This will make Xwayland issues with NVIDIA more manageable.</li>
<li>Install <code>fcitx5-im</code> and <code>fcitx5-chinese-addons</code> using <code>yay</code>, and select <em>Fcitx 5</em> in System Settings &gt; Keyboard &gt; Virtual Keyboard; add <em>Pinyin</em> as an Input Method.</li>
<li>Copy <code>.ssh/id_rsa</code>, <code>.ssh/config</code>, and <code>.ssh/id_rsa.pub</code> from Windows on the same device.</li>
<li>Enable <code>mdns</code> and <code>kdeconnect</code> in the Firewall configuration.</li>
<li>Configure Firefox:
<ul>
<li>Extensions:
<ul>
<li>Mainichi</li>
<li>uBlock Origin</li>
<li>Bitwarden</li>
<li>floccus</li>
</ul>
</li>
<li>Always show the bookmark bar.</li>
<li>Disable Recommend extensions and features as you browse.</li>
<li>Enable Proxy DNS when using SOCKS v5.</li>
<li>Disable DNS over HTTPS.</li>
<li>Disable Ask to save passwords.</li>
<li>Enable “Tell websites not to sell or share my data” and “Send websites a Do Not Track (DNT) request”.</li>
<li>Uncheck all checkboxes in Firefox Data Collection and Use.</li>
<li>Uncheck “Block dangerous and deceptive content”.</li>
<li>Toggle <code>identity.fxaccounts.enabled</code> to <code>false</code> in <code>about:config</code>.</li>
<li>Toggle <code>extensions.pocket.enabled</code> to <code>false</code> in <code>about:config</code>.</li>
<li>Set the homepage to “Blank Page”.</li>
</ul>
</li>
<li>Disable “Show small window previews when hovering over tasks” in task manager options.</li>
<li>Arch packages installed with <code>pacman</code>:
<ul>
<li>flatpak</li>
<li>thunderbird</li>
<li>obsidian
<ul>
<li>Create <code>.config/obsidian/user-flags.conf</code> with <code>--ozone-platform-hint=wayland --enable-wayland-ime</code>.</li>
</ul>
</li>
<li>bitwarden
<ul>
<li>Create <code>.config/electron28-flags.conf</code> with the following content:  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--ozone-platform-hint=wayland</span><br><span class="line">--enable-wayland-ime</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>fastfetch</li>
<li>docker
<ul>
<li>Add the current user to the docker group: <code>sudo usermod -aG docker $USER</code>.</li>
</ul>
</li>
<li>cuda</li>
<li>libreoffice-fresh
<ul>
<li>Create <code>.config/environment.d/env-vars.conf</code> with <code>SAL_USE_VCLPLUGIN=gtk3</code>. This can fix text and icon sizes.</li>
</ul>
</li>
<li>btop</li>
<li>htop</li>
<li>bottom</li>
<li>nvtop</li>
<li>gst-plugins-qsv</li>
<li>gst-plugins-bad</li>
<li>libva-utils</li>
<li>intel-media-driver</li>
<li>intel-media-sdk</li>
<li>intel-gpu-tools</li>
<li>handbrake</li>
<li>gimp</li>
<li>krita</li>
<li>thunderbird</li>
<li>kdenlive</li>
<li>remmina</li>
<li>freerdp</li>
<li>discover</li>
<li>kid3</li>
<li>merkuro</li>
<li>zanshin</li>
<li>tokodon</li>
<li>kasts</li>
<li>telegram-desktop</li>
<li>ttf-jetbrains-mono</li>
<li>zeal</li>
<li>kubectl</li>
<li>kubectx</li>
<li>zsh</li>
<li>rustup</li>
<li>nextcloud-client</li>
<li>neovim</li>
<li>tmux</li>
<li>inkscape</li>
<li>pastel</li>
<li>yt-dlp</li>
<li>k3b</li>
<li>bat</li>
<li>dust</li>
<li>git-delta</li>
<li>eza</li>
<li>eva</li>
<li>fd</li>
<li>gitui</li>
<li>glow</li>
<li>gron</li>
<li>xh</li>
<li>pipe-rename</li>
<li>procs</li>
<li>yazi</li>
<li>ttf-hack-nerd</li>
<li>rclone</li>
<li>ripgrep</li>
<li>silicon</li>
<li>skim</li>
<li>tokei</li>
<li>viu</li>
<li>zellij</li>
<li>timeshift
<ul>
<li>Setup daily btrfs snapshots.</li>
<li><code>systemctl enable cronie</code>.</li>
</ul>
</li>
<li>nvidia-container-toolkit</li>
<li>speech-dispatcher</li>
<li>cmatrix</li>
</ul>
</li>
<li>AUR packages installed with <code>yay</code>:
<ul>
<li>logseq-desktop-bin
<ul>
<li>Note: Wayland has not been enabled for Logseq due to a bug causing the window to shrink with each start and occasional crashes on close.</li>
</ul>
</li>
<li>visual-studio-code-bin
<ul>
<li>Create <code>.config/code-flags.conf</code> with the following content:  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--ozone-platform-hint=wayland</span><br><span class="line">--enable-wayland-ime</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>vlc-git</li>
<li>xone-dkms</li>
<li>spotify
<ul>
<li>Create <code>.config/spotify-flags.conf</code> with the following content:  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--enable-features=UseOzonePlatform </span><br><span class="line">--ozone-platform=wayland</span><br><span class="line">--enable-wayland-ime</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>drawio-desktop</li>
<li>kopia-ui-bin
<ul>
<li>Set up daily backups of the home directory.</li>
</ul>
</li>
<li>plex-mpv-shim
<ul>
<li>Open TCP 3000 and UDP 32410-32414 ports in firewall settings.</li>
<li>Set up auto-start in <code>~/.config/systemd/user/plex-mpv-shim.service</code>:  <figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=Plex MPV Shim Service</span><br><span class="line"><span class="attr">After</span>=network.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/bin/plex-mpv-shim</span><br><span class="line"><span class="attr">Restart</span>=always</span><br><span class="line"><span class="attr">RestartSec</span>=<span class="number">3</span></span><br><span class="line"><span class="attr">Environment</span>=GDK_BACKEND=x11</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=default.target</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl --user daemon-reload</span><br><span class="line">systemctl --user <span class="built_in">enable</span> plex-mpv-shim.service</span><br><span class="line">systemctl --user start plex-mpv-shim.service</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li>Flatpak apps:
<ul>
<li>Ungoogled Chromium
<ul>
<li>Create <code>~/.var/app/com.github.Eloston.UngoogledChromium/config/chromium-flags.conf</code> with <code>--ozone-platform-hint=wayland --enable-wayland-ime</code>.</li>
</ul>
</li>
<li>Android Studio</li>
<li>OpenLens</li>
<li>DBeaver Community</li>
<li>Zotero</li>
<li>Discord</li>
<li>Plexamp</li>
<li>Flatseal</li>
<li>Gear Lever</li>
</ul>
</li>
<li>AppImage apps:
<ul>
<li>Insomnia</li>
</ul>
</li>
<li>Configure mpv for hardware decoding: create <code>~/.config/mpv.conf</code> and <code>~/.config/plex-mpv-shim/mpv.conf</code> with <code>hwdec=auto-copy</code>. Additionally, add the command <code>set hwdec auto-copy</code> in Haruna Media Player.</li>
<li>Install <code>prezto</code>:  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">zsh</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> --recursive https://github.com/sorin-ionescu/prezto.git <span class="string">&quot;<span class="variable">$&#123;ZDOTDIR:-<span class="variable">$HOME</span>&#125;</span>/.zprezto&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setopt</span> EXTENDED_GLOB</span><br><span class="line"><span class="keyword">for</span> rcfile <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;ZDOTDIR:-<span class="variable">$HOME</span>&#125;</span>&quot;</span>/.zprezto/runcoms/^README.md(.N); <span class="keyword">do</span></span><br><span class="line"><span class="built_in">ln</span> -s <span class="string">&quot;<span class="variable">$rcfile</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;ZDOTDIR:-<span class="variable">$HOME</span>&#125;</span>/.<span class="variable">$&#123;rcfile:t&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<ul>
<li>Configure Konsole command to <code>/bin/zsh</code></li>
<li>Add pmodules in <code>.zpreztorc</code>: <code>git</code>, <code>syntax-highlighting</code>, <code>ssh</code>, <code>tmux</code>, <code>fasd</code> before <code>prompt</code></li>
</ul>
</li>
<li>Install <code>goenv</code>:  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/go-nv/goenv.git ~/.goenv</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export GOENV_ROOT=&quot;$HOME/.goenv&quot;&#x27;</span> &gt;&gt; ~/.zshenv</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$GOENV_ROOT/bin:$PATH&quot;&#x27;</span> &gt;&gt; ~/.zshenv</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;eval &quot;$(goenv init -)&quot;&#x27;</span> &gt;&gt; ~/.zshrc</span><br><span class="line">goenv install 1.22</span><br></pre></td></tr></table></figure>
</li>
<li>Install <code>fnm</code>:  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://fnm.vercel.app/install | bash</span><br><span class="line">fnm install 20</span><br></pre></td></tr></table></figure>
</li>
<li>Set up the rust toolchain and install some cargo applications:  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rustup install stable</span><br><span class="line">cargo install cargo-update</span><br><span class="line">cargo install dtool</span><br><span class="line">cargo install --locked csview</span><br><span class="line">cargo install fclones</span><br></pre></td></tr></table></figure>
<ul>
<li>Append <code>export PATH=&quot;$HOME/.local/bin:$HOME/.cargo/bin:$PATH&quot;</code> to <code>.zshrc</code>.</li>
</ul>
</li>
<li>Append aliases to <code>.zshrc</code>:  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> comet-core=<span class="string">&quot;ssh comet-core.lan -t &#x27;tmux new-session -A -s main&#x27;&quot;</span></span><br><span class="line"><span class="built_in">alias</span> porygon2=<span class="string">&quot;ssh porygon2.lan -t &#x27;tmux new-session -A -s main&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> vim=<span class="string">&quot;nvim&quot;</span></span><br><span class="line"><span class="built_in">alias</span> vi=<span class="string">&quot;nvim&quot;</span></span><br><span class="line"><span class="built_in">alias</span> vimdiff=<span class="string">&quot;nvim -d&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> EDITOR=<span class="string">&quot;nvim&quot;</span></span><br><span class="line"><span class="built_in">export</span> GIT_EDITOR=<span class="string">&quot;nvim&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li>Check that the Intel iGPU works for video encoding: <code>LIBVA_DRIVER_NAME=iHD vainfo --display drm --device /dev/dri/renderD129</code>.</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mudkip.me/2024/02/28/Spiritual-Successor-to-the-Google-Nexus-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mudkip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/02/28/Spiritual-Successor-to-the-Google-Nexus-7/" class="post-title-link" itemprop="url">Spiritual Successor to the Google Nexus 7</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-02-28 01:48:05" itemprop="dateCreated datePublished" datetime="2024-02-28T01:48:05Z">2024-02-28</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/images/2024/02/lenovo-legion-y700.jpg" alt="Lenovo Legion Y700"></p>
<p>The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Nexus_7_(2012)">Google Nexus 7</a>, released in 2012, is the first “small tablet computer” I can recall. It featured a pleasing 800p display, a powerful processor for its time, and shipped with a “stock Android” system. I used a Nexus 7 for a few years alongside an iPad Mini, which was subsequently replaced by a larger iPad Air 2. Although the device has not been with me for many years, the memories of reading manga on a perfectly sized device and the hackable Android experience, including running a bash shell and emulators, always lead me to seek the spiritual successor to the Google Nexus 7.</p>
<p>For the past two years, I have been using the <a target="_blank" rel="noopener" href="https://www.gsmarena.com/lenovo_legion_y700-11394.php">Lenovo Legion Y700 (2022)</a> as my primary device for content consumption. It comes equipped with a Snapdragon 870 processor, 256GB of storage, 12GB of RAM, and an 8.8-inch 120Hz 2K display. Similar to the Google Nexus 7, there is an improved “2023” version featuring a Snapdragon 8 Gen 1 processor. However, the older 2022 model suffices for my needs, and I prefer its <em>advanced</em> 3.5mm audio port.</p>
<p>While the hardware performance is excellent and the freedom to install apps from various sources—such as Google Play, <a target="_blank" rel="noopener" href="https://f-droid.org/">F-Droid</a>, GitHub, or directly from the developer’s website—<em>feels right</em>, I have never felt good about its ZUI operating system or any Android OEM system. I appreciate that Lenovo doesn’t include too much bloatware, doesn’t require me to log in to its account, and natively supports Google Play Services, but there are always moments when I encounter buggy or peculiar issues with some apps, or something just doesn’t seem right with the OS.</p>
<p>On the other side, for the past two years, a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Pixel_6a">Google Pixel 6a</a> installed with <a target="_blank" rel="noopener" href="https://grapheneos.org/">GrapheneOS</a> has been my secondary phone. While the hardware is decent, it kind of underperforms when compared to an iPhone or a Snapdragon 8-equipped Android device. However, the open-source operating system is more than just great. It offers many secure features, and even Google Play Services can be run in a sandbox to protect privacy and battery life. I can disable network access for Google Camera, Photos, and Gboard while still keeping their on-device ML features. Additionally, I can place some apps that I don’t trust as much in a Work Profile with <a target="_blank" rel="noopener" href="https://f-droid.org/en/packages/net.typeblog.shelter/">Shelter</a>, making other apps and data invisible to these apps.</p>
<p>In the end, I learned that the bootloader of the Lenovo tablet can be unlocked, and I discovered <a target="_blank" rel="noopener" href="https://android-developers.googleblog.com/2017/05/here-comes-treble-modular-base-for.html">Project Treble</a> and the Generic System Image (GSI), which enable the availability of custom Android distributions on most devices without excessive difficulties. Weeks ago, I followed <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=zQ0Guo1v9LA">this video</a> and installed <a target="_blank" rel="noopener" href="https://crdroid.net/">crDroid</a> on my Lenovo Legion Y700.</p>
<p>crDroid, a fork of LineageOS, offers a pure and customizable Android experience. After experimenting with it for a few hours, I deeply regret not replacing the OS on this tablet sooner. Using an open-source stock-like Android system is incredibly refreshing. The UI is smooth, and I can truly appreciate the 120fps screen while navigating. It brings back memories from more than a decade ago with the Google Nexus 7, making me realize that I’m holding what could be considered the <strong>spiritual successor to the Google Nexus 7</strong>.</p>
<h2 id="System-Experience">System Experience</h2>
<p>As is common with most custom images lacking official support, there are a few caveats when using a GSI ROM on this tablet, but I can say that I have <em>fewer</em> issues with crDroid than with the stock ZUI.</p>
<p>The settings and issues worth noting are:</p>
<ul>
<li>120fps can be enabled under Settings &gt; Phh Treble Settings &gt; Misc features &gt; Force FPS, by setting it to 1600x2560@120.00001.</li>
<li>Lock screen rotation can be activated by going to Settings, searching for “rotation,” and selecting “Rotate lock screen.” I also enabled all rotation modes here.</li>
<li>The 3.5mm audio port does not work initially, but it can be fixed under Settings &gt; Phh Treble Settings &gt; Qualcomm features &gt; “Use alternate audio policy.”</li>
<li>The double-tap to wake feature is not operational yet, but, surprisingly, the Lenovo screen cover lock/unlock feature does work.</li>
<li>Adaptive brightness does not work.</li>
<li>Changing Wallpaper crashes initially, which is fixed by installing <a target="_blank" rel="noopener" href="https://github.com/FossifyOrg/Gallery">Fossify Gallery</a>.</li>
</ul>
<p>The crDroid launcher is a lightweight fork of the Google Pixel launcher. Initially, I preferred it as it is similar to the launcher used in GrapheneOS, so I was already accustomed to it. However, there is an issue where the background of the app drawer remains dark even when using the light theme, which may be due to some compatibility issues with the tablet size or the enabling of the work profile. As a result, I switched to <a target="_blank" rel="noopener" href="https://niagaralauncher.app">Niagara Launcher</a>, and it looks perfect.</p>
<p>I also learned a valuable lesson: Unlike Pixel phones, Lenovo does not allow the re-locking of the bootloader once a non-stock OS is installed. The first action I took after installing <a target="_blank" rel="noopener" href="https://github.com/naz664/crDroid_gsi">crDroid_gsi</a> was attempting to re-lock the bootloader. Subsequently, the tablet became bricked, displaying a message that the system was corrupted and could not boot. Thankfully, the tablet could be unbricked by following <a target="_blank" rel="noopener" href="https://xdaforums.com/t/guide-unbrick-lenovo-y700-tablet.4509297/">this guide</a>.</p>
<h2 id="Privacy-and-Security">Privacy and Security</h2>
<p>In terms of security, I’m content with the basic Android security model, but it’s important to note that the tablet is less secure than a Pixel equipped with GrapheneOS.</p>
<p>Keeping the bootloader unlocked is clearly a security risk, as theoretically, a thief with hardware access could install a hacked ROM to decrypt data on the device. Additionally, the face recognition feature on this device is less secure than Apple’s Face ID or the face unlock feature on the Pixel 8, meaning a thief could theoretically mimic my face to unlock this device.</p>
<p>I do not consider a tech-savvy thief attempting to access my data to be within my threat model. Nonetheless, I choose not to store sensitive data on this tablet, and I also disabled biometric unlock in <a target="_blank" rel="noopener" href="https://bitwarden.com/">Bitwarden</a> after setting up most of my apps.</p>
<p>While crDroid does not come with sandboxed Google Play Services like GrapheneOS does, disabling the advertising ID, personalization, autofill, and location settings is sufficient for my privacy needs regarding Google.</p>
<p>One theoretical privacy threat when using mobile devices is the possibility of manufacturers or popular apps harvesting the list of installed apps on the device and potentially sharing this information with authorities, which could result in phone calls from “anti-fraud offices” warning about the risks of certain apps. While this is all theoretical and without neither any evidence nor my own experience, using an open-source system can definitely mitigate such threats. Similar to my setup on my Pixel phone, I use Shelter to isolate certain apps within a Work Profile.</p>
<h2 id="Apps">Apps</h2>
<p>Despite it being over a decade since the launch of Nexus 7, there are still not many Android apps optimized for tablet size. However, since Android does not restrict non-optimized apps to run in a centered window like the iPad, most Android apps function adequately on this smaller tablet. Additionally, the operating system supports basic multitasking features, such as split-screen.</p>
<p>I prefer to install apps from <a target="_blank" rel="noopener" href="https://github.com/NeoApplications/Neo-Store">Neo Store</a> when possible, which is a frontend for F-Droid and also supports <a target="_blank" rel="noopener" href="https://apt.izzysoft.de/fdroid/">IzzyOnDroid</a> by default. For apps that are only available through GitHub releases, I can update them automatically using <a target="_blank" rel="noopener" href="https://github.com/ImranR98/Obtainium">Obtainium</a>.</p>
<p>Here is a list of apps worth mentioning on this tablet:</p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/uazo/cromite">Cromite</a></strong>: The default browser, featuring built-in ad blocking and privacy enhancements.</li>
<li><strong><a target="_blank" rel="noopener" href="https://www.davx5.com/">DAVx5</a> and <a target="_blank" rel="noopener" href="https://github.com/Etar-Group/Etar-Calendar">Etar</a></strong>: Used for syncing calendars with Nextcloud.</li>
<li><strong><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=allen.town.focus.reader">FocusReader</a></strong>: An RSS client connecting to <a target="_blank" rel="noopener" href="https://github.com/miniflux/v2">Miniflux</a>.</li>
<li><strong><a target="_blank" rel="noopener" href="https://gitnex.com/">GitNex</a></strong>: A client for <a target="_blank" rel="noopener" href="https://forgejo.org">Forgejo</a>.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/zhanghai/MaterialFiles">Material Files</a></strong>: A file manager supporting SMB.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/mihonapp/mihon">Mihon</a></strong>: A manga reader and <a target="_blank" rel="noopener" href="https://github.com/gotson/komga">Komga</a> client.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/mudkipme/MoeMemosAndroid">Moe Memos</a></strong>: A note-taking app developed by me.</li>
<li><strong><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.mxtech.videoplayer.pro">MX Player Pro</a></strong>: Used for watching local videos not in my Plex library.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/TeamNewPipe/NewPipe">NewPipe</a></strong>: Considered the best YouTube client.</li>
<li><strong><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.google.android.apps.books">Play Books</a></strong>: Used for reading ePub books, chosen for its page-turn animation.</li>
<li><strong><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.plexapp.android">Plex</a> and <a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=tv.plex.labs.plexamp">Plexamp</a></strong>: My primary media players.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/j-fbriere/squawker">Squawker</a></strong>: Used to subscribe to voice actors from the former birdsite.</li>
<li><strong><a target="_blank" rel="noopener" href="https://f-droid.org/en/packages/com.cosmos.unreddit/">Stealth</a></strong>: A Reddit client.</li>
<li><strong><a target="_blank" rel="noopener" href="https://tasks.org/">Tasks.org</a></strong>: For to-do lists syncing with Nextcloud.</li>
<li><a target="_blank" rel="noopener" href="https://termux.dev/">Termux</a>: A powerful terminal emulator.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/erickok/transdroid">Transdroid</a></strong>: Used to manage my qBittorrent server.</li>
<li><strong><a target="_blank" rel="noopener" href="https://tusky.app/">Tusky</a></strong>: A Mastodon client.</li>
<li><strong><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.mickstarify.zooforzotero">Zoo for Zotero</a></strong>: For reading from my PDF library.</li>
</ul>
<h2 id="Gaming">Gaming</h2>
<p>The Lenovo Legion Y700 is marketed as a “gaming tablet.” Although I am not a mobile gamer—since most modern mobile games adopt a freemium, casino-like business model that I feel detracts from the concept of video games as works of art—Android remains an excellent platform for emulation and game streaming. This tablet has the capability to emulate <a target="_blank" rel="noopener" href="https://github.com/Trixarian/NetherSX2-classic">PS2</a> and <a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=org.dolphinemu.dolphinemu">Wii</a> games at full speed with upscaled textures, as well as stream PC games via <a target="_blank" rel="noopener" href="https://github.com/moonlight-stream/moonlight-android">Moonlight</a>, or PS5 games using <a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=psplay.grill.com">PSPlay</a> or <a target="_blank" rel="noopener" href="https://sr.ht/~thestr4ng3r/chiaki/">Chiaki</a>, all with negligible latency.</p>
<p>Gaming on Android devices represents a larger story for me, but it’s not particularly tied to this tablet or the Pixel phone. I’m keeping it a secret for now and may discuss it in more detail in the future.</p>
<h2 id="Conclusion">Conclusion</h2>
<p>The journey to find the spiritual successor to the Google Nexus 7 led me to the Lenovo Legion Y700, a device that, while initially not perfect due to its ZUI operating system, transformed into a nearly ideal tablet experience after installing crDroid. This shift back to a stock-like Android experience reminiscent of the Nexus 7 days has been both nostalgic and enlightening, proving that the essence of a great tablet is not just in its hardware but in the freedom and flexibility of its software. The Lenovo Legion Y700, with its powerful specs and the newfound joy of a pure Android experience, serves as a testament to the enduring appeal of customizable, user-centric technology. It reminds us that sometimes, the true successor to a beloved piece of technology is not about finding an identical replacement, but about recapturing the spirit of innovation and openness that made the original so special.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mudkip.me/2024/01/31/My-2023-Homelab-Setup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mudkip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/01/31/My-2023-Homelab-Setup/" class="post-title-link" itemprop="url">My 2023 Homelab Setup</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-01-31 02:21:12" itemprop="dateCreated datePublished" datetime="2024-01-31T02:21:12Z">2024-01-31</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/images/2024/01/homelab.jpg" alt="Homelab, Illustrated By DALL·E"></p>
<p>Homelab is a place where you can store all your family’s data, self-host applications and services, locally stream media, and experiment with various technologies.</p>
<p>A Homelab can start with low-power devices such as a Raspberry Pi, or with hacking your router to install open-source firmware and run custom applications. It can also involve easy-to-use consumer NAS solutions like Synology. Alternatively, you might find yourself overwhelmed by used data center hardware.</p>
<p>Throughout 2023, I have been tinkering with my home network and computing setup, which has been both fun and rewarding.</p>
<h2 id="Hardware">Hardware</h2>
<p>Various devices operate continuously at my home. Some were shelved last year, but there are a few newcomers worth mentioning.</p>
<p>The router “Rotom,” which I use for my home’s internet, is an <a target="_blank" rel="noopener" href="https://www.ikoolcore.com/products/ikoolcore-r1-pro">iKoolCore R1</a>. This compact device is powered by a Celeron N5105 processor and is equipped with 8GB of RAM, a 128GB SSD, and four 2.5GbE Ethernet ports. It runs <a target="_blank" rel="noopener" href="https://www.proxmox.com/en/proxmox-virtual-environment/overview">Proxmox VE</a>, hosting an <a target="_blank" rel="noopener" href="https://openwrt.org/">OpenWRT</a> VM as my primary firewall, and a Debian VM for several networking applications.</p>
<p>This summer, I noticed that the SSD became read-only on several occasions due to overheating. Fortunately, the manufacturer offers an R1 Pro upgrade kit. This kit replaces the case with a heatsink that directly contacts the NVMe SSD, effectively mitigating the overheating issue. Additionally, it includes a PWM fan, which keeps this compact computer silent in my closet.</p>
<p><img src="/images/2024/01/network-cabinet.jpg" alt="My Network Cabinet in Augest 2023"></p>
<p>I have a 15U network cabinet situated in the corner of my living room. At the bottom lies a <a target="_blank" rel="noopener" href="https://www.santak.com/">Santak</a> TG-BOX 850 UPS, safeguarding the devices within the cabinet. Positioned in the middle is my NAS, acquired in 2020 – a <a target="_blank" rel="noopener" href="https://www.synology.com/en-us/products/DS1621+">Synology DS1621+</a> equipped with six 8TB HGST drives and 12GB of ECC RAM. It’s set up in a RAID-6 configuration, providing a total storage capacity of 32TB.</p>
<p>At the top of the cabinet is the Homelab server “Porygon,” which I assembled in 2023. Inspired by <a target="_blank" rel="noopener" href="https://taoofmac.com/space/blog/2023/02/18/1845">Tao of Mac</a>, it’s built around an <a target="_blank" rel="noopener" href="https://www.asrock.com/nettop/Intel/DeskMeet%20B660%20Series/">ASRock DeskMeet B660</a> box. The configuration includes an Intel Core i7 12700 CPU, 128GB of DDR4 RAM, two NVMe SSDs (a WD SN770 2TB and an older Samsung 970 Evo Plus 1TB), and a Geforce RTX 3060 GPU.</p>
<p>The DeskMeet B660 also runs Proxmox VE. The integrated Iris Xe GPU is dedicated to a <a target="_blank" rel="noopener" href="https://fedoraproject.org/workstation/">Fedora Workstation</a> VM for transcoding videos and offering a remote desktop. The RTX 3060 switches between a Windows VM, which I use for game streaming, and a Debian VM for doing AI experiments.</p>
<p>However, I’ve encountered heat issues with the “Porygon” server inside the network cabinet. The CPU, cooled by a <a target="_blank" rel="noopener" href="https://noctua.at/en/nh-l9i-17xx">Noctua NH-L9i-17xx</a>, can quickly reach 100°C during moderately intensive tasks. The SSD, even with a heatsink, often heats up to 70°C. To address this, I implemented two solutions. Firstly, I replaced the PSU fan with a <a target="_blank" rel="noopener" href="https://noctua.at/en/nf-a12x25-pwm">Noctua NF-A12</a>, which reduced the CPU temperature by 15°C, both at idle and under load, at the cost of <a target="_blank" rel="noopener" href="https://indieweb.social/@mudkip/111661590832909428">injuring both my hands</a>. Secondly, I installed a dedicated cabinet fan controlled by a Xiaomi Smart Plug. When the SSD temperature hits 70°C, Home Assistant activates the fan, which turns off once the temperature drops below 65°C. Ultimately, I’m quite content with the new Homelab server. It’s usually quiet and energy-efficient, yet it can be exceptionally powerful when needed.</p>
<h2 id="Applications-and-Services">Applications and Services</h2>
<p>In my Homelab, I run a wide array of applications, catering to various needs. This includes network applications that ensure connectivity for my devices at home and allow me to access my home network remotely. I also use note-taking apps, read-later services, home automation systems, media management services, file synchronization programs, RSS readers, as well as a git server complemented by CI/CD pipelines. Moreover, I have dashboards in place to navigate and monitor all these applications efficiently. It’s fair to say that a significant portion of my digital life depends on these machines, which are entirely under my control at home.</p>
<p><img src="/images/2024/01/homepage.png" alt="Homepage Dashboard and my Applications"></p>
<h3 id="On-my-router-“Rotom”">On my router “Rotom”</h3>
<p>On the compact yet capable machine, I have set up two virtual machines and one LXC container to manage various services and applications.</p>
<p>One VM operates as my primary router OS, running OpenWRT. I’ve configured it with passthrough for three NIC ports. The WAN port connects to the modem provided by my ISP, while the LAN ports, in conjunction with the VM net port, establish a bridged LAN network. The majority of OpenWRT’s <a href="https://mudkip.me/2023/04/09/Project-Update-2023-Q1/#Home-Projects">configuration</a> revolves around DHCP settings and firewall rules.</p>
<p>In addition to the routing functions, “Rotom” hosts several other programs:</p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/jellyfin/jellyfin">Jellyfin</a></strong>: This serves as my secondary media center. I’m contemplating a switch from Plex to Jellyfin since it is fully open-source and doesn’t depend on a remote server.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/fatedier/frp">frpc</a></strong>: This is for exposing certain services, like an SSH service that enables me to connect back to my home network. It’s useful because I have a CG-NAT IPv4 network. If I encounter a lack of IPv6 support in an external Wi-Fi network, I rely on frp to access my home network.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/cloudflare/cloudflared">cloudflared</a></strong>: This acts as an alternative method for exposing services via Cloudflare Tunnels.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/timothymiller/cloudflare-ddns">cloudflare-ddns</a></strong>: A dynamic DNS service that maintains an AAAA record, facilitating direct IPv6 connections back to my home.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/traefik/traefik">traefik</a></strong>: This reverse proxy manages services not running on “Porygon.” I’ll detail the services running on the Homelab PC separately.</li>
</ul>
<p>Jellyfin operates within an LXC container, with the Intel iGPU passed through for video transcoding. The remaining services are housed in Docker containers running on a Debian VM. The Debian VM also functions as a <em>side router</em> for my Homelab PC and devices such as the Apple TV and Sonos One.</p>
<h3 id="On-my-Synology-NAS-“Uxie”">On my Synology NAS “Uxie”</h3>
<p>As my storage center, I need my NAS to be as robust as possible, so I haven’t installed too many applications on it.</p>
<p>In addition to standard NAS services like SMB, NFS, and File Station, the applications I use include:</p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="https://www.synology.com/en-global/dsm/feature/photos">Synology Photos</a></strong>: Backs up the photos of my family. I’m considering switching to an open-source solution like Immich, but the last time I tried, Immich didn’t integrate well with the iCloud Photo Library.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/qbittorrent/qBittorrent">qBittorrent</a></strong> and <strong><a target="_blank" rel="noopener" href="https://github.com/VueTorrent/VueTorrent">VueTorrent</a></strong>: Mostly used to download <em>Linux ISOs</em>.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/aria2/aria2">aria2</a></strong>: Another tool for downloading <em>Linux ISOs</em>.</li>
<li><strong><a target="_blank" rel="noopener" href="https://codeberg.org/forgejo/forgejo">Forgejo</a></strong>: A self-hosted Git server; it’s lightweight and a community fork of Gitea.</li>
<li><strong><a target="_blank" rel="noopener" href="https://www.sonatype.com/products/sonatype-nexus-oss-download">Sonatype Nexus Repository</a></strong>: My private package manager for Docker and npm, and also a cache proxy for <a target="_blank" rel="noopener" href="http://docker.io">docker.io</a> and <a target="_blank" rel="noopener" href="http://ghcr.io">ghcr.io</a> to ensure all my applications can start without an internet connection.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/minio/minio">MinIO</a></strong>: An S3-like object storage service for my other applications.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/navidrome/navidrome">Navidrome</a></strong>: A lightweight music manager compatible with the Subsonic API.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/Sonarr/Sonarr">Sonarr</a></strong>: An automatic media manager for anime and TV shows.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/Radarr/Radarr">Radarr</a></strong>: An automatic media manager for movies.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/morpheus65535/bazarr">Bazarr</a></strong>: A subtitle downloader for content in Sonarr and Radarr.</li>
</ul>
<p>Apart from first-party Synology apps, all third-party programs are running in Docker containers.</p>
<h3 id="A-Home-Kubernetes-Cluster-in-“Porygon”">A Home Kubernetes Cluster in “Porygon”</h3>
<p>I’ve migrated the <a target="_blank" rel="noopener" href="https://github.com/k3s-io/k3s">k3s</a> control plane and worker VMs from Frost Canyon NUC “Comet” to my new Homelab PC. Most of my applications are running in this k3s cluster because it’s easy to maintain, upgrade, and recover. Building this has also been a great way to learn.</p>
<p>Here’s a list of applications running in this cluster:</p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/usememos/memos">Memos</a></strong>: My primary note-taking app for capturing my thoughts and ideas. I also developed the iOS and Android client titled “<a target="_blank" rel="noopener" href="https://memos.moe/">Moe Memos</a>.”</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/miniflux/v2">Miniflux</a></strong>: My RSS reader. It supports the Fever and Google Reader API and can be connected to various RSS clients.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/dani-garcia/vaultwarden">Vaultwarden</a></strong>: An unofficial server written in Rust for the open-source password manager Bitwarden. It’s more lightweight than the official server.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/wallabag/wallabag">Wallabag</a></strong>: My link manager and “read later” app.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/szabodanika/microbin">MicroBin</a></strong>: A text and file-sharing application for when I’m transferring things without Universal Clipboard.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/nocodb/nocodb">NocoDB</a></strong>: An AirTable-like smart spreadsheet. I use it for personal project management and to track games and movies.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/gotson/komga">Komga</a></strong>: My manga library. It supports OPDS clients like Panels and Mihon.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/paperless-ngx/paperless-ngx">Paperless-ngx</a></strong>: A document management system for organizing scanned documents.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/Stirling-Tools/Stirling-PDF">Stirling PDF</a></strong>: An all-in-one PDF toolkit.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/advplyr/audiobookshelf">Audiobookshelf</a></strong>: I use it as an automatic podcast downloader.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/photoview/photoview">Photoview</a></strong>: I use it to manage collected pictures <em>not</em> in my photo library, such as CD and Blu-ray booklets.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/Prowlarr/Prowlarr">Prowlarr</a></strong> backed by <strong><a target="_blank" rel="noopener" href="https://github.com/FlareSolverr/FlareSolverr">FlareSolverr</a></strong>: An indexer manager for Sonarr/Radarr.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/Tzahi12345/YoutubeDL-Material">YoutubeDL-Material</a></strong>: Downloads videos from YouTube via <a target="_blank" rel="noopener" href="https://github.com/yt-dlp/yt-dlp">yt-dlp</a>.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/jgraph/drawio">draw.io</a></strong>: The most powerful diagramming tool.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/kimai/kimai">Kimai</a></strong>: A self-hosted time tracker.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/firefly-iii/firefly-iii">Firefly III</a></strong>: A self-hosted finance manager. I haven’t used it much yet.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/node-red/node-red">Node-RED</a></strong> and <strong><a target="_blank" rel="noopener" href="https://github.com/n8n-io/n8n">n8n</a></strong>: Powerful automation tools, but I haven’t used them much yet.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/woodpecker-ci/woodpecker">Woodpecker CI</a></strong>: A Kubernetes native continuous integration solution.</li>
</ul>
<p>The manifest of my Kubernetes cluster is managed in a Git repository and is automatically deployed via a GitOps tool named <a target="_blank" rel="noopener" href="https://github.com/fluxcd/flux2">Flux CD</a>. When I push changes to the repository, such as adding a new application or upgrading Docker images, the deployment occurs within a few minutes.</p>
<p>Recently, I discovered a powerful tool named <a target="_blank" rel="noopener" href="https://github.com/renovatebot/renovate">Renovate Bot</a>. It scans my Kubernetes manifest repository every few hours to identify which Helm releases or container image tags require upgrades and then creates pull requests in Forgejo, similar to how Dependabot operates on GitHub.</p>
<p>In addition to the applications I’m running, my setup includes the <a target="_blank" rel="noopener" href="https://github.com/kubernetes/ingress-nginx">Ingress NGINX Controller</a>, <a target="_blank" rel="noopener" href="https://github.com/metallb/metallb">MetalLB</a>, and <a target="_blank" rel="noopener" href="https://github.com/cert-manager/cert-manager">cert-manager</a> to facilitate service access and manage certificates. The data for these applications is stored on <a target="_blank" rel="noopener" href="https://github.com/longhorn/longhorn">Longhorn</a> volumes, which are replicated across all three worker VMs and two SSDs. I’ve also integrated <a target="_blank" rel="noopener" href="https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack">Kube Prometheus Stack</a> and <a target="_blank" rel="noopener" href="https://github.com/grafana/loki">Grafana Loki</a> to monitor the cluster and review pod logs.</p>
<p>Another tool I use in parallel with <code>kubectl</code> for managing resources in the cluster is <a target="_blank" rel="noopener" href="https://github.com/portainer/portainer">Portainer</a>. I’ve also configured Portainer environments to manage Docker Compose stacks on my NAS, router, and several cloud servers. For convenient navigation through all the apps in my Homelab, I utilize a highly customizable dashboard named <a target="_blank" rel="noopener" href="https://github.com/gethomepage/homepage">Homepage</a>. It seamlessly integrates with Kubernetes and is capable of discovering services based on Ingress annotations.</p>
<p>All k3s nodes operate under Ubuntu 22.04, and I’ve configured the <a target="_blank" rel="noopener" href="https://github.com/rancher/system-upgrade-controller">system-upgrade-controller</a> to automatically update k3s and apt.</p>
<h3 id="Remote-Development-and-Desktop">Remote Development and Desktop</h3>
<p>Like my Kubernetes cluster, The Fedora Workstation VM “comet-core” is also migrated from the Frost Canyon NUC. The Intel Iris Xe iGPU is passed through it. I use it mostly as a remote development server, and when I need GUI applications, I can access the <a target="_blank" rel="noopener" href="https://www.gnome.org/">GNOME desktop</a> with RDP via <a target="_blank" rel="noopener" href="https://github.com/neutrinolabs/xrdp">xrdp</a> and <a target="_blank" rel="noopener" href="https://github.com/neutrinolabs/xorgxrdp">xorgxrdp</a>.</p>
<p>Notable applications running in this VM contains:</p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="https://www.plex.tv/">Plex</a></strong>: My primary media library. I have lifetime Plex Pass and I still prefer Plex for a variety of unique features. But I’m kinda worried about Plex’s <a target="_blank" rel="noopener" href="https://techcrunch.com/2023/01/05/streamer-plex-finally-ready-to-launch-a-tv-and-movie-rentals-marketplace/">future</a> and its <a target="_blank" rel="noopener" href="https://www.techhive.com/article/2157803/plex-discover-together-privacy-concerns.html">troublesome handling of privacy</a>. Maybe I’ll switch to Jellyfin some day.</li>
<li><strong><a target="_blank" rel="noopener" href="https://github.com/coder/code-server">code-server</a></strong>: A web development environment. However, I often develop on this VM via the <a target="_blank" rel="noopener" href="https://code.visualstudio.com/docs/remote/remote-overview">Remote Development</a> feature in Visual Studio Code.</li>
<li><strong><a target="_blank" rel="noopener" href="https://calibre-ebook.com">calibre</a></strong> and <strong><a target="_blank" rel="noopener" href="https://github.com/janeczku/calibre-web">calibre-web</a></strong>: My book library. I also use calibre to DeDRM and convert digital books I bought.</li>
<li><strong><a target="_blank" rel="noopener" href="https://handbrake.fr/">Handbrake</a></strong>: I use it to transcode videos from my Blu-ray collection to H.265 with Intel Quick Sync.</li>
</ul>
<h3 id="Gaming-and-AI-Experiments">Gaming and AI Experiments</h3>
<p>Having a dedicated GPU has significantly justified upgrading my Homelab PC. I’ve set up a Windows VM “Porygon-Z” and a Debian VM “Porygon2,” both configured to utilize the RTX 3060 GPU. However, only one VM can be powered on at a time since GPU passthrough is restricted to a single VM.</p>
<p>In the Debian VM, I’ve been experimenting with a few smaller LLM apps such as <a target="_blank" rel="noopener" href="https://ollama.ai/">Ollama</a> and <a target="_blank" rel="noopener" href="https://github.com/THUDM/ChatGLM-6B/blob/main/README_en.md">ChatGLM-6B</a>, as well as creating art with the <a target="_blank" rel="noopener" href="https://github.com/AUTOMATIC1111/stable-diffusion-webui">Stable Diffusion web UI</a>. I’ve also explored vector databases such as <a target="_blank" rel="noopener" href="https://github.com/chroma-core/chroma">Chroma</a>.</p>
<p>On the Windows VM, I’ve installed <a target="_blank" rel="noopener" href="https://github.com/LizardByte/Sunshine">Sunshine</a>, primarily to stream games from PC Game Pass, and titles that are either unsupported or don’t perform well on the Steam Deck, to my handheld console with <a target="_blank" rel="noopener" href="https://moonlight-stream.org/">Moonlight</a>. The ability to play games at 1080p 60fps with the highest settings on a handheld device was a dream I never thought would be possible until now.</p>
<h3 id="Other-VMs-and-LXC-Containers">Other VMs and LXC Containers</h3>
<p>Last but not least, I’d like to highlight more applications.</p>
<p><a target="_blank" rel="noopener" href="https://nextcloud.com/">Nextcloud</a> serves as my file synchronization server. It used to perform poorly, particularly when syncing a large number of small files. However, with recent upgrades to both Nextcloud versions and my hardware, its performance has significantly improved, offering super-fast file transfers. I’ve set up Nextcloud with <a target="_blank" rel="noopener" href="https://github.com/nextcloud/all-in-one">Nextcloud AIO</a> in an LXC container on “Porygon.” Beyond file syncing, Nextcloud also manages my calendar and tasks through CalDAV and syncs browser bookmarks using <a target="_blank" rel="noopener" href="https://floccus.org/">Floccus</a>.</p>
<p><a target="_blank" rel="noopener" href="https://www.home-assistant.io/">Home Assistant OS</a> orchestrates all my IoT devices and bridges them to HomeKit. For devices that don’t natively support HomeKit, I can access them through <a target="_blank" rel="noopener" href="https://github.com/al-one/hass-xiaomi-miot">hass-xiaomi-miot</a>. Home Assistant also automates various tasks, such as controlling the network cabinet fan I mentioned earlier and activating the Aqara M1S night light when someone enters the living room at night.</p>
<h2 id="Backups">Backups</h2>
<p>I loosely adhere to the 3-2-1 backup strategy for safeguarding my data. My NAS serves as the primary backup target for various devices, including my family’s iMac via Time Machine and two Proxmox VE devices using a <a target="_blank" rel="noopener" href="https://www.proxmox.com/en/proxmox-backup-server/overview">Proxmox Backup Server</a> <a target="_blank" rel="noopener" href="https://www.synology.com/en-global/dsm/feature/virtual_machine_manager">VM</a>. Additionally, my older Synology DS916+ NAS, which has been operational for 8 years, secures the data from my main NAS through <a target="_blank" rel="noopener" href="https://kb.synology.com/en-us/DSM/help/DSM/AdminCenter/application_backupserv_sharedfoldersync?version=7">rsync</a> and <a target="_blank" rel="noopener" href="https://www.synology.com/en-global/dsm/feature/hyper_backup">Hyper Backup</a>.</p>
<p>For offsite backup, I utilize <a target="_blank" rel="noopener" href="https://www.backblaze.com/cloud-storage">Backblaze B2</a> and OneDrive. Backblaze B2 houses backups from Hyper Backup, <a target="_blank" rel="noopener" href="https://github.com/restic/restic">restic</a>, Longhorn, and <a target="_blank" rel="noopener" href="https://www.arqbackup.com/">Arq</a>, while selected folders from my NAS are one-way synced to OneDrive using <a target="_blank" rel="noopener" href="https://www.synology.com/en-global/dsm/feature/cloud_sync">Cloud Sync</a>. I’ve opted not to have a remote backup for my media library due to the storage costs, considering that most of the content can be reacquired by re-ripping physical media or re-downloading.</p>
<h2 id="Homelab-in-2024">Homelab in 2024</h2>
<p>That’s all for my 2023 Homelab setup. I’m very satisfied with my current setup, and there are a few areas I’d like to explore.</p>
<p>Currently, I only have Gigabit Ethernet, even though I have a few 2.5GbE devices. Perhaps I should add a few 2.5GbE switches to access my data faster.</p>
<p>I’d like to make the most of my devices. I’m considering reconfiguring my Frost Canyon NUC as a backup device in case one or two pieces of hardware in my Homelab fail. It happened before with the Noctua CPU fan, and I lost access to “Porygon” for a few days. I also have a spare <a target="_blank" rel="noopener" href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/">Raspberry Pi 4</a> and a <a target="_blank" rel="noopener" href="https://www.raspberrypi.com/products/raspberry-pi-zero-2-w/">Zero 2 W</a>, but I haven’t figured out how to utilize them effectively.</p>
<p>I’m also interested in open-source NAS solutions such as <a target="_blank" rel="noopener" href="https://github.com/trapexit/mergerfs">mergerfs</a>, <a target="_blank" rel="noopener" href="https://github.com/amadvance/snapraid">SnapRAID</a>, and <a target="_blank" rel="noopener" href="https://github.com/openmediavault/openmediavault">openmediavault</a>, but I’m not yet motivated to build one. I’m looking into VLAN setup as well, although I don’t think I really need it yet.</p>
<p>Overall, I have enjoyed my Homelab journey and am looking forward to more building and learning. I hope you enjoyed reading this post, and if you have any suggestions or ideas, please reach out to me on <a target="_blank" rel="noopener" href="https://indieweb.social/@mudkip">Mastodon</a>.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mudkip.me/2023/10/18/Object-Storage-Migration-Case-Study/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mudkip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/10/18/Object-Storage-Migration-Case-Study/" class="post-title-link" itemprop="url">Object Storage Migration Case Study</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-10-18 00:21:01" itemprop="dateCreated datePublished" datetime="2023-10-18T00:21:01Z">2023-10-18</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Background">Background</h2>
<p>Hundreds of thousands of image files are stored on <a target="_blank" rel="noopener" href="https://52poke.wiki/">52Poké Wiki</a>. Previously, we used AWS S3 to store all these images, AWS Lambda for image processing (generating thumbnails and converting to WebP format), and two layers of cache (a container on Linode and Cloudflare CDN) for image distribution.</p>
<p>Our monthly AWS bill increased gradually due to the growing number of images and traffic each month. Even with two layers of cache, more than 280GB of traffic defaulted to AWS S3, incurring a $20 expense every month.</p>
<p>Fortunately, there are many S3-compatible services available at much more competitive prices. We considered switching to Cloudflare R2, Backblaze B2, or Linode Object Storage.</p>
<h2 id="Choice">Choice</h2>
<p>Currently, we have 150GB of files. It costs $2.25 every month to store on Cloudflare R2, $0.9 for Backblaze B2, and $5 for Linode Object Storage. Egress traffic charges are zero for all services: Backblaze B2 doesn’t charge for 3x the monthly data stored, Linode uses a traffic pool that sufficiently covers our usage, and Cloudflare never charges for egress bandwidth. If the data storage increases to 250GB, it will cost $3.75 on Cloudflare, $1.5 on Backblaze, and remain $5 on Linode.</p>
<p>However, since the main services of 52Poké are located in Linode’s Tokyo datacenter, there is significant latency when proxying from the other side of the Pacific Ocean. Linode recently <a target="_blank" rel="noopener" href="https://www.linode.com/blog/linode/core-compute-regions-milan-and-osaka/">announced</a> Object Storage availability in their Osaka datacenter, and with a latency of only 8ms between Tokyo and Osaka, this is an optimal choice performance-wise. We can also eliminate one cache layer (20GB) backed by block storage, saving $2 monthly. Ultimately, by migrating from AWS S3 to Linode Object Storage, we can save $17 every month.</p>
<h2 id="Steps">Steps</h2>
<h3 id="Creating-a-Bucket-on-Linode-and-Setting-Up-the-Bucket-Policy">Creating a Bucket on Linode and Setting Up the Bucket Policy</h3>
<p>We can create an Object Storage bucket in Akamai Cloud Manager with the bucket name <code>media.52poke.com</code>.</p>
<p>Previously, we configured a bucket policy on S3 to allow access solely from the IP addresses of 52Poké’s cloud servers. While Akamai Cloud Manager doesn’t support direct bucket policy configurations, they can be set up using <code>s3cmd</code> as per <a target="_blank" rel="noopener" href="https://www.linode.com/docs/products/storage/object-storage/guides/bucket-policies/">Linode’s documentation</a>.</p>
<p>The bucket policy looks like this:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;s3:GetObject&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:s3:::media.52poke.com/*&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;Condition&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;IpAddress&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;aws:SourceIp&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                        <span class="string">&quot;...&quot;</span></span><br><span class="line">                    <span class="punctuation">]</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Full-Migration">Full Migration</h3>
<p>To minimize disruption to 52Poké Wiki during this migration, we’ll implement a two-step mechanism. First, we’ll migrate all files from the AWS S3 bucket and allow users to upload or update files. Later, we’ll conduct an incremental migration, which should take considerably less time.</p>
<p>A Kubernetes job will be used to run <code>rclone sync</code> to sync all files to the new Linode Object Storage bucket. For the access key ID and secret access key of Linode Object Storage, we’ll use <a target="_blank" rel="noopener" href="https://fluxcd.io/flux/guides/mozilla-sops/">SOPS</a> to encrypt and store them in the Git repository. These can then only be decrypted with the private key in the 52Poké Kubernetes cluster and deployed automatically.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">batch/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Job</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">migrate-media</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ttlSecondsAfterFinished:</span> <span class="number">100</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">command:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">/bin/sh</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">rclone</span> <span class="string">sync</span> <span class="string">awss3:media.52poke.com</span> <span class="string">los:media.52poke.com</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_AWSS3_TYPE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">s3</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_AWSS3_ACCESS_KEY_ID</span></span><br><span class="line">          <span class="attr">valueFrom:</span></span><br><span class="line">            <span class="attr">secretKeyRef:</span></span><br><span class="line">              <span class="attr">key:</span> <span class="string">accessKeyID</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">aws-s3</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_AWSS3_SECRET_ACCESS_KEY</span></span><br><span class="line">          <span class="attr">valueFrom:</span></span><br><span class="line">            <span class="attr">secretKeyRef:</span></span><br><span class="line">              <span class="attr">key:</span> <span class="string">secretAccessKey</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">aws-s3</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_LOS_TYPE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">s3</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_LOS_ACCESS_KEY_ID</span></span><br><span class="line">          <span class="attr">valueFrom:</span></span><br><span class="line">            <span class="attr">secretKeyRef:</span></span><br><span class="line">              <span class="attr">key:</span> <span class="string">accessKeyID</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">linode-object-storage</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_LOS_SECRET_ACCESS_KEY</span></span><br><span class="line">          <span class="attr">valueFrom:</span></span><br><span class="line">            <span class="attr">secretKeyRef:</span></span><br><span class="line">              <span class="attr">key:</span> <span class="string">secretAccessKey</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">linode-object-storage</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_LOS_ENDPOINT</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">jp-osa-1.linodeobjects.com</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">rclone/rclone:latest</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">Always</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">migrate-media</span></span><br><span class="line">      <span class="attr">restartPolicy:</span> <span class="string">Never</span></span><br></pre></td></tr></table></figure>
<h3 id="Disabling-Uploads">Disabling Uploads</h3>
<p>In the second step, we must disable uploads on MediaWiki to prevent data loss. This can be configured via <code>LocalSettings.php</code>.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$wgEnableUploads</span> = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Incremental-Migration">Incremental Migration</h3>
<p>We’ll now run the Kubernetes job again to sync updates from the old AWS S3 bucket to the new one. Additionally, we’ll manually check that recently uploaded files from 52Poké Wiki have been synced to the new bucket.</p>
<h3 id="Updating-Malasada">Updating Malasada</h3>
<p><a target="_blank" rel="noopener" href="https://github.com/mudkipme/malasada">Malasada</a> is an AWS Lambda Serverless function designed to generate image thumbnails and convert images to the WebP format to conserve bandwidth.</p>
<p>Previously, we used an IAM policy to grant the Serverless function access to the S3 bucket. Now, with the shift from AWS S3, we’ll need to manually provide the access key ID, secret access key, and the endpoint of Linode Object Storage to the Serverless function using environment variables.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> s3 = <span class="keyword">new</span> <span class="title function_">S3</span>(&#123;</span><br><span class="line">    <span class="attr">credentials</span>: &#123;</span><br><span class="line">        <span class="attr">accessKeyId</span>: process.<span class="property">env</span>.<span class="property">S3_ACCESS_KEY_ID</span>,</span><br><span class="line">        <span class="attr">secretAccessKey</span>: process.<span class="property">env</span>.<span class="property">S3_SECRET_ACCESS_KEY</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">endpoint</span>: process.<span class="property">env</span>.<span class="property">S3_ENDPOINT</span>,</span><br><span class="line">    <span class="attr">region</span>: process.<span class="property">env</span>.<span class="property">S3_REGION</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Configuring-Nginx">Configuring Nginx</h3>
<p>The Nginx configuration for the domains <code>media.52poke.com</code>, <code>s0.52poke.wiki</code>, and <code>s1.52poke.wiki</code> must be updated to replace the AWS S3 domain with that of Linode Object Storage. We also removed the persistent volume claim backed by block storage from the nginx deployment.</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">proxy_pass</span> http://media.52poke.com.jp-osa-1.linodeobjects.com<span class="variable">$request_uri</span>;</span><br></pre></td></tr></table></figure>
<p>After updating the nginx configuration, we noticed all requests were failing due to permission issues. However, there was no issue when requesting the upstream Object Storage URL with <code>curl</code> in the nginx container.</p>
<p>Upon further investigation, we determined that Linode Object Storage was blocking requests containing “X-Forwarded-For” and “X-Real-IP” headers because these headers didn’t align with the bucket policy. Removing these headers from the request resolved the issue.</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">proxy_set_header</span> X-Real-IP <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Configuring-MediaWiki">Configuring MediaWiki</h3>
<p>We now need to adjust the <a target="_blank" rel="noopener" href="https://github.com/edwardspec/mediawiki-aws-s3">AWS S3 MediaWiki extension</a> to use Linode Object Storage instead of AWS S3. This adjustment can be quickly made via the <code>endpoint</code> parameter. Afterward, we can re-enable file uploading on MediaWiki.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$wgFileBackends</span>[<span class="string">&#x27;s3&#x27;</span>][<span class="string">&#x27;endpoint&#x27;</span>] = <span class="string">&#x27;http://jp-osa-1.linodeobjects.com&#x27;</span>;</span><br><span class="line"><span class="variable">$wgEnableUploads</span> = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Configuring-WordPress">Configuring WordPress</h3>
<p>The 52Poké homepage uses the <a target="_blank" rel="noopener" href="https://wordpress.org/plugins/amazon-s3-and-cloudfront/">WP Offload Media Lite</a> plugin to upload files to S3. While the plugin’s admin page doesn’t offer functionality to change the object storage endpoint, our investigation of the source code revealed hooks that allow modifying the S3 connection configuration. This can be adjusted in <code>wp-config.php</code>.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">add_filter</span>( <span class="string">&#x27;as3cf_aws_s3_client_args&#x27;</span>, function ( <span class="variable">$args</span> ) &#123;</span><br><span class="line">    <span class="variable">$args</span>[<span class="string">&#x27;endpoint&#x27;</span>]               = <span class="string">&#x27;https://jp-osa-1.linodeobjects.com&#x27;</span>;</span><br><span class="line">    <span class="variable">$args</span>[<span class="string">&#x27;region&#x27;</span>]                 = <span class="string">&#x27;jp-osa-1&#x27;</span>;</span><br><span class="line">    <span class="variable">$args</span>[<span class="string">&#x27;use_path_style_endpoint&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$args</span>;</span><br><span class="line">&#125; );</span><br><span class="line"><span class="title function_ invoke__">add_filter</span>( <span class="string">&#x27;as3cf_aws_get_regions&#x27;</span>, function ( <span class="variable">$regions</span> ) &#123;</span><br><span class="line">    <span class="variable">$regions</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;jp-osa-1&#x27;</span> =&gt; <span class="string">&#x27;Osaka&#x27;</span>,</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$regions</span>;</span><br><span class="line">&#125; );</span><br><span class="line"><span class="title function_ invoke__">add_filter</span>( <span class="string">&#x27;as3cf_aws_s3_bucket_in_path&#x27;</span>, <span class="string">&#x27;__return_true&#x27;</span> );</span><br><span class="line"><span class="title function_ invoke__">add_filter</span>( <span class="string">&#x27;as3cf_aws_s3_domain&#x27;</span>, function ( <span class="variable">$domain</span> ) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;linodeobjects.com&#x27;</span>;</span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure>
<h3 id="Backup">Backup</h3>
<p>As the migration nears completion, it’s important to remember that we have a cron job set up to back up files from AWS S3 to Backblaze B2. We’ll need to update the backup source to Linode Object Storage, which can be achieved through the environment variables of <code>rclone</code>.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">env:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_MEDIA_TYPE</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">s3</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_MEDIA_ACCESS_KEY_ID</span></span><br><span class="line">  <span class="attr">valueFrom:</span></span><br><span class="line">	<span class="attr">secretKeyRef:</span></span><br><span class="line">	  <span class="attr">key:</span> <span class="string">accessKeyID</span></span><br><span class="line">	  <span class="attr">name:</span> <span class="string">linode-object-storage</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_MEDIA_SECRET_ACCESS_KEY</span></span><br><span class="line">  <span class="attr">valueFrom:</span></span><br><span class="line">	<span class="attr">secretKeyRef:</span></span><br><span class="line">	  <span class="attr">key:</span> <span class="string">secretAccessKey</span></span><br><span class="line">	  <span class="attr">name:</span> <span class="string">linode-object-storage</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">RCLONE_CONFIG_MEDIA_ENDPOINT</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">jp-osa-1.linodeobjects.com</span></span><br></pre></td></tr></table></figure>
<h2 id="Conclusion">Conclusion</h2>
<p>52Poké Wiki successfully transitioned from AWS S3 to Linode Object Storage for image storage. Despite the availability of lower-cost options like Cloudflare R2 and Backblaze B2, Linode Object Storage was the optimal choice given its low latency benefits and the site’s primary services being located in Linode’s Tokyo datacenter. With this change, we anticipates a monthly savings of $17 and enhanced performance. Through a careful migration process, including addressing challenges with permissions and configurations, the transition was executed smoothly. This move underscores the importance of regularly evaluating and optimizing infrastructure choices to ensure both cost-effectiveness and performance for online communities.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://mudkip.me/2023/04/09/Project-Update-2023-Q1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mudkip">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Mudkip Mud Sport">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/04/09/Project-Update-2023-Q1/" class="post-title-link" itemprop="url">Project Updates (Q1 2023)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-04-09 14:28:04" itemprop="dateCreated datePublished" datetime="2023-04-09T14:28:04Z">2023-04-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Home-Projects">Home Projects</h2>
<p>As my family moved to a new place, I have been rearranging our network and computer equipment.</p>
<p>The first new hardware to arrive at my home in 2023 is an <a target="_blank" rel="noopener" href="https://www.ikoolcore.com/">iKOOLCORE R1</a>. It is a tiny x86 computer with four 2.5GbE NICs pre-installed with Proxmox VE and OpenWrt. I named this device <em>“rotom”</em> and use it as a router. I also set up a Debian VM called <em>“rotom-core”</em> as a “side gateway.” This addition has vastly improved my home network experience, in terms of both responsiveness and functionality.</p>
<p>I have tinkered with a few configurations of the open-source router system. One benefit of OpenWrt is its ability to configure IPv6 firewalls. I wanted to open a specific port on <em>rotom-core</em> to allow me to connect back to my home network while blocking all other incoming connections. However, most home networks have dynamic IPv6 address prefixes, and only the suffix is static. Fortunately, this can be easily set up in OpenWrt:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">config rule</span><br><span class="line">        option target &#x27;ACCEPT&#x27;</span><br><span class="line">        option src &#x27;wan&#x27;</span><br><span class="line">        option dest &#x27;lan&#x27;</span><br><span class="line">        option name &#x27;&lt;rule name&gt;&#x27;</span><br><span class="line">        option family &#x27;ipv6&#x27;</span><br><span class="line">        option proto &#x27;tcp&#x27;</span><br><span class="line">        option dest_ip &#x27;::&lt;IPv6 address suffix&gt;/::ffff:ffff:ffff:ffff&#x27;</span><br><span class="line">        option dest_port &#x27;&lt;Port I want to open&gt;&#x27;</span><br></pre></td></tr></table></figure>
<p>I wanted certain devices on my home network to use <em>rotom-core</em> as the gateway; however, some devices (like Sonos) do not allow for configuring static IP and gateway. To address this, I added an entry in the DHCP settings to pin the DHCP response to these devices.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">config host</span><br><span class="line">        option name &#x27;SonosOne&#x27;</span><br><span class="line">        option dns &#x27;1&#x27;</span><br><span class="line">        option mac &#x27;&lt;mac address&gt;&#x27;</span><br><span class="line">        option ip &#x27;192.168.1.31&#x27;</span><br><span class="line">        option tag &#x27;tag1&#x27;</span><br><span class="line"></span><br><span class="line">config tag &#x27;tag1&#x27;</span><br><span class="line">        option dhcp_option &#x27;3,192.168.1.2 6,192.168.1.2&#x27;</span><br></pre></td></tr></table></figure>
<p>One issue I faced previously was the inability to change or disable the IPv6 DNS server on Android, rendering the DNS server settings useless in a dual-stack network environment. OpenWrt allows me to disable the announcement of the IPv6 DNS server address.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config dhcp &#x27;lan&#x27;</span><br><span class="line">        ...</span><br><span class="line">        option dns_service &#x27;0&#x27;</span><br></pre></td></tr></table></figure>
<p>In <em>rotom-core</em>, besides the critical services I prefer not to mention, there are also containers running <a target="_blank" rel="noopener" href="https://github.com/fatedier/frp">frpc</a> and <a target="_blank" rel="noopener" href="https://github.com/cloudflare/cloudflared">cloudflared</a> to enable connection to my home network from IPv4-only networks. Additionally, there is <a target="_blank" rel="noopener" href="https://github.com/timothymiller/cloudflare-ddns">cloudflare-ddns</a> to update the AAAA record in DNS.</p>
<p>After receiving this new tiny PC, I benchmarked it using <a target="_blank" rel="noopener" href="https://packages.debian.org/bullseye/p7zip-full">p7zip</a> and compared it to my Frost Canyon NUC (<em>“comet”</em>, named after Comet Lake). Surprisingly, it outperformed the i7-10710U by 200% in both single-core and multi-core tests, which indicated an issue with the NUC.</p>
<p>Two possibilities came to my mind. I thought it could be related to how VMware ESXi handles turbo boost, or the cooling system in the NUC had melted down. After turning off the NUC and waiting for half an hour, the CPU speed greatly improved, but it soon hit rock bottom. Thus, it must be the cooling.</p>
<p>There are various videos suggesting that the thermal silicone between the CPU and cooler needs to be replaced. I purchased a small Honeywell phase change pad and prepared to fix the NUC. However, I made a mistake at the first step; I broke a screw on the motherboard, and it was impossible to pull out.</p>
<p>I eventually gave up and only cleaned the air outlet of the cooler. Surprisingly, it worked. Now, the NUC is much faster and makes significantly less noise than before. I regret not noticing this problem earlier.</p>
<p>A k3s worker node VM in <em>comet</em> has been replaced by a Fedora Workstation VM named <em>“comet-core”</em>, since the services in the home Kubernetes cluster don’t require too much memory. I want to experiment with different Linux distributions, and the VM allows me to work on tasks that the Raspberry Pi can’t handle.</p>
<p>I also migrated the hypervisor of <em>comet</em> from VMware ESXi to Proxmox VE. Initially, I wanted to try <a target="_blank" rel="noopener" href="https://3os.org/infrastructure/proxmox/gpu-passthrough/igpu-split-passthrough/#proxmox-configuration-for-gvt-g-split-passthrough">GVT-g Split Passthrough</a> to enable both the Windows VM and the Fedora VM to access the iGPU. However, the split performance was not sufficient to provide a smooth RDP experience. Nevertheless, I appreciate Proxmox VE’s flexibility and LXC features.</p>
<h2 id="52Poke">52Poké</h2>
<p>52Poké Wiki has been upgraded to MediaWiki 1.39, featuring numerous improvements under the hood. I am a fan of the new Vector-2022 skin<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> (with the <code>max-width</code> option disabled). It is clear, vibrant, responsive, and fully-fledged.</p>
<p>The Kubernetes cluster of 52Poké is now synchronized with <a target="_blank" rel="noopener" href="https://github.com/mudkipme/52poke">this git repository</a> via GitOps, using <a target="_blank" rel="noopener" href="https://fluxcd.io/">FluxCD</a>. Additionally, the database server has been moved into the cluster, thanks to NVMe Block Storage. All nodes have been upgraded to 4 CPU core 8GB memory instances, and the number of nodes has been reduced (currently only 2), helping to decrease the total cost.</p>
<p>One issue that occasionally stresses the 52Poké Wiki is when editing a template used by hundreds of pages. MediaWiki attempts to purge the cache of every page using this template. When hundreds of pages load without cache, the MediaWiki instance may freeze. I am developing a <a target="_blank" rel="noopener" href="https://github.com/mudkipme/52poke/wiki/Inazuma">new web server</a> to address this issue. It will implement a persistent cache layer, inspired by the concept of <a target="_blank" rel="noopener" href="https://developers.cloudflare.com/cache/about/cache-reserve/">Cloudflare Cache Reserve</a>. This approach allows the cache purging process to work in an asynchronous queue, updating the persistent cache instead of deleting it. Ideally, this will enable the backend MediaWiki instance to handle much fewer requests while ensuring that page edits are updated for all visitors as quickly as possible.</p>
<p>Since April 2023, Linode (now Akamai Connected Cloud) has increased its computing prices by 20%. This has prompted me to consider how to maintain the long-term sustainability of 52Poké Wiki. Up until now, I have been covering all the monthly bills from Linode, but there is always a risk of facing financial difficulties at some point in the coming years. I hope that 52Poké Wiki can eventually be partly supported by its community and visitors; however, I have not yet found a viable solution to achieve this.</p>
<h2 id="Moe-Memos">Moe Memos</h2>
<p>Initially, <a target="_blank" rel="noopener" href="http://memos.moe/">Moe Memos</a> was a niche open-source project developed to meet my personal needs and maintain my hands-on experience with app development. However, it has since become a much larger success. As of now, over 3,500 users have installed the app from App Store and Google Play (excluding GitHub and F-Droid downloads). It has evolved into a feature-rich app for <a target="_blank" rel="noopener" href="https://github.com/usememos/memos">Memos</a> while maintaining its minimalistic design.</p>
<p>I still have many ideas for this charming project, ranging from implementing major features such as local storage (hoping for a revamp of Core Data this June) and multi-server/user support, to refactoring the project structure and adding a tipping feature to motivate me to continue working on it and explore more ideas for the self-hosted community.</p>
<h2 id="AI-Experiments">AI Experiments</h2>
<p>The past few months have undoubtedly been an AI Summer, with news related to AI projects such as ChatGPT, New Bing, Office 365 Copilots, Stable Diffusion, and Midjourney flooding my mind every few hours.</p>
<p>I initially tried to resist the hype, but I eventually succumbed after the release of the GPT-3.5-Turbo API and GPT-4 model. I experimented with various things involving LLMs and AI art generators. I read a letter that Yui from Sword Art Online sent to Asuna and Kirito and asked her what everyday life is like as an AI in the VRMMO world. I <a href="https://mudkip.me/2023/03/16/Interviewing-Luna-a-Pokemon-Trainer-from-Slateport-City/">interviewed a Pokémon Trainer in Hoenn</a> about her epic journey. I asked ChatGPT to write <a target="_blank" rel="noopener" href="https://github.com/mudkipme/inazuma/tree/0.0.1">the first commit of the web server</a> I mentioned earlier. I even allowed it to be a Pikachu with no knowledge of human language, experiencing the atmosphere of Snowpoint City and battling a Glalie. In addition, I have written stories such as “Takami Chika Meets Her Real World Counterpart Inami Anju” and “The Birth of Amane Suzuha in the Steins;Gate Timeline”. I also used Midjourney to design alternative icons for Moe Memos.</p>
<p>Another entertaining project stemmed from an idea inspired by Persona 5. I asked ChatGPT, “You are the main character of Persona 5. You found a palace belonging to Donald Trump. What does Donald Trump’s palace look like, and how will your team obtain the treasure within it?” The response was both hilarious and reasonable. I tried a few other names, ranging from real-world villains to absurdities like “<a target="_blank" rel="noopener" href="https://indieweb.social/@mudkip/110057112299714330">MacBook Pro with Butterfly Keyboard</a>.” Eventually, I created a <em><a target="_blank" rel="noopener" href="https://p5-palace-generator.vercel.app/">Persona 5 Palace Generator</a></em> in about an hour with ChatGPT’s help. I have more intriguing ideas stemming from this, but I prefer to keep them secret for now.</p>
<p>I am still uncertain about how LLMs, generative AI, and future AGI will change our world, or whether the change will be overwhelmingly positive. I remain concerned that <a target="_blank" rel="noopener" href="https://indieweb.social/@stevestreza/109674963990228250">widespread poverty may result from these advances</a>. I still prefer to enjoy <a target="_blank" rel="noopener" href="https://mastodon.gamedev.place/@bitinn/110089849000582865">technologies I can reason with, predict, and reproduce variants of</a>. I am annoyed by the <a target="_blank" rel="noopener" href="https://indieweb.social/@mudkip/110078732296586867">racial/regional discrimination</a> that makes it difficult to use and pay for OpenAI and other services. I hope humanity can find and <a target="_blank" rel="noopener" href="https://indieweb.social/@mudkip/110157754411778217">imagine</a> a path to a better future.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>I understand that there are many controversies surrounding the Vector-2022 skin in the Wikipedia community, and perhaps within 52Poké/Encyclopaediae Pokémonis as well. <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Mudkip</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.31/dist/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/fancybox.js"></script>



  





</body>
</html>
